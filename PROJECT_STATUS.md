# 项目状态

**更新时间**: 2026-02-09

## 项目概述

Bitget 加密货币量化交易系统 — 支持多策略（剥头皮 + 网格）、多交易类型（合约 + 现货）的自动化交易平台。

## 当前状态：v2.0 多策略架构完成，运行时调试中

### 架构层 — 已完成
- [x] 统一交易类型抽象（`TradingType`, `StrategyType`）
- [x] 服务接口层（`IOrderService`, `IMarketDataService`, `IAccountService`）
- [x] 适配器层（合约 3 个 + 现货 3 个适配器）
- [x] 服务工厂（根据交易类型自动创建服务组合）
- [x] 策略接口（`IStrategy`）+ 策略管理器（`StrategyManager` Singleton）

### 策略层 — 已完成
- [x] 剥头皮策略引擎（依赖注入重构，支持合约+现货）
- [x] 网格策略引擎（等差/等比网格，买卖循环）
- [x] 网格位管理器（状态机 + 订单映射）
- [x] 风控系统（回撤限制、日亏限制、仓位限制）
- [x] 挂单合并引擎（加权平均价）
- [x] 风险等级预设（保守/均衡/激进）
- [x] 自动计算引擎（4 参数 → 完整配置 + 推导过程）
- [x] 策略配置持久化（DB 存储 + 启动恢复）
- [x] 订单持久化（DB 存储 + pending 订单恢复）

### 服务层 — 已完成
- [x] Bitget API 客户端（认证、签名、模拟盘/实盘切换）
- [x] 合约 API 服务（行情、订单、账户）
- [x] 现货 API 服务（行情、订单、资金）
- [x] 合约规格服务（三层缓存：内存→DB→API）
- [x] 现货规格服务（三层缓存）
- [x] 统一规格门面（`InstrumentSpecService`）
- [x] 持仓模式检测（`getHoldMode` — hedge/one-way 自动识别）

### 前端 — 已完成
- [x] 策略控制面板（启动/停止/紧急停止）
- [x] 实时指标卡片（PnL、胜率、持仓、余额）
- [x] 订单追踪表格 + 事件日志
- [x] 配置向导（简单模式 4 参数 / 高级模式全参数）
- [x] 策略类型选择器（剥头皮 vs 网格）
- [x] 交易对选择器（搜索 + 热门快选 + 分类浏览）
- [x] 网格配置表单（价格区间 + 网格预览）
- [x] 参数动态边界（实时 min/max）

### 基础设施 — 已完成
- [x] PostgreSQL 数据库 + 4 个迁移脚本
- [x] Docker Compose 部署（nginx + api + frontend + postgres）
- [x] 数据库自动迁移（启动时运行）
- [x] 10 个 Claude Code agents

### API 端点 — 已完成
- [x] 策略控制（启动/停止/配置/状态/PnL/订单/事件/紧急停止）
- [x] 合约规格查询
- [x] 交易对搜索/热门列表
- [x] 自动计算 + 参数边界
- [x] 账户余额（现货/合约分类）
- [x] 订单管理 + 行情查询

### 运行时问题 — 调试中
- [ ] post_only 买单在模拟盘被频繁撤销（已添加自适应偏移 + GTC 降级机制）
- [ ] 卖单 22002 错误（仓位未结算） — 已添加 7 次重试 + market 单兜底

### 待开发
- [ ] WebSocket 实时数据推送（替代 REST 轮询）
- [ ] 回测系统
- [ ] 单元测试 / 集成测试
- [ ] 多实例并行运行
- [ ] 资金费率监控

## 最近更新

- **2026-02-09** — v2.0 多策略架构重构（4 阶段，51 文件）
- **2026-02-09** — tradeSide 参数修复 + post_only 自适应
- **2026-02-09** — 模拟盘适配 + 账户余额修复
- **2026-02-08** — 新增前端策略面板 + Docker 部署
- **2026-02-08** — 新增合约策略引擎 + 风控系统
- **2026-02-08** — 项目初始化

---

最后更新：2026-02-09
